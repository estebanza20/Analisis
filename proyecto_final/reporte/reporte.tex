%Archivo de muestra de un Informe de práctica o laboratorio
% utilizando la clase eieinforme.cls (V.M. Alfaro)
%---------------------------------------------------------------------

%preámbulo - uso de la clase eieinforme
\documentclass{eieinforme}
%
%--------- <Agregue aquí algún paquete extra que sea necesario---------
\usepackage{booktabs}
\usepackage{url}
\usepackage[spanish]{babel}

%--------- Agregue aquí algún paquete extra que sea necesario>---------
%
\begin{document}
\pagenumbering{roman}

%------------ Desde aquí datos de la portada ------------------%

%título de la práctica (* Por el usuario *)
\title{Proyecto final:\\ Modelado del comportamiento de los robots de dos ruedas}

%nombre del curso (* Por el usuario *)
\curso{IE-0409 Análisis de Sistemas}

%nombre completo de los autores (* Por el usuario *)
\autorA{Ariel Fallas Pizarro, B42481}
\autorB{Daniel García Vaglio, B42781}
\autorC{Esteban Zamora Alvarado, B47769}

%fecha de presentación (* si se deja en blanco indicará la fecha de la compilación)
%\date{Mes de año}

%---------------hasta aquí datos de la portada-------------------------
%
%--------------------------------------------------------------------------------
%portada
\eietitlepage
\newpage
%--------------------------------------------------------------------------------
%
%---------------------------------------------------------------------------------
%------------- A partir de aquí se escribe el informe ----------------------------
%---------------------------------------------------------------------------------
%las siguientes son las secciones iniciales del informe

%Esto hay que revisarlo!

Los robots móviles son muy importantes porque permiten sistemas más flexibles. Además abren toda un área de la robótica que es el problema de localización%referencias.
En este documento se analiza el caso específico de un robot diferencial, este es un sistema que se moviliza en el plano xy debido a la acción de dos ruedas que funcionan de manera independiente. El principal objetivo es la obtención de un modelo cinemático directo, un modelo cinemático inverso, y un modelo dinámico que describa el sistema real. Se realizaron simulaciones, para verificar que la respuesta del modelo sea la esperada. 

%-------------------
%tablas de contenido (* si alguna no se ocupa se puede ``comentar'' (%) para que no aparezca)
\newpage
\tableofcontents
\newpage
\listoffigures
\newpage
\listoftables
\newpage

%-------------------------------------------------------------------
%lista de la nomenclatura utilizada en el texto

\section*{Nomenclatura}

\begin{description}[labelindent=1cm,labelwidth=2.25cm,align=left]
%ponerlo en orden alfabetico
        \item[$L$] Lagrangiano de un sistema
        \item[$T$] Energía cinética de un sistema
        \item[$V$] Energía potencial de un sistema
        \item[$q_j$] Coordenada generalizada
        \item[$Q_j$] Fuerza generalizada
        \item[$n$] Cantidad de grados de libertad de un sistema
        \item[$J$] Momento de inercia de un cuerpo
        \item[$m$] Masa de un cuerpo
        \item[$\vec{v}$] Velocidad del centro de masa de un cuerpo
        \item[$\omega$] Velocidad angular
        \item[$k$] Constante de un resorte traslacional
        \item[$x$] Elongación de un resorte traslacional
        \item[$h$] Altura del centro de masa de un cuerpo con respecto a la referencia
        \item[$g$] Constante de la gravedad terrestre
\end{description}

%--------------------
\newpage
\pagenumbering{arabic}
\pagestyle{fancy}
\setlength\headheight{14.5pt}
\lhead{\nouppercase{\leftmark}}
\rhead{\thepage}
\fancyfoot{}

% ------------------------------------------------------------------ Secciones del informe (puede
% ser un solo archivo o separarse los secciones en archivos independientes e incluirse
% con \include('nombre_archivo') si se quiere una nueva página antes de la parte que se está
% anexando o \input{'nombre de archivo'} si se quiere agregar directamente en la posición donde se
% llama a \input{}


%------------------
\section{Introducción}
%ESto hay que hacerlo, supongo que con la primera parte del marco teorico está bien...

\section{Marco teórico}

\subsection{Importancia y aplicación de los robots de dos ruedas}

El desarrollo de robots móviles, responde a la necesidad de extender el campo de aplicación de la
Robótica en la actualidad. En este campo, se trata de incrementar la autonomía del robot, limitando
en todo lo posible la necesidad de intervención humana \citep{Collazo}.

El presente trabajo, se centra alrededor de la descripción del movimiento de péndulo invertido que
ocurre en los robots móviles de dos ruedas. Las aplicaciones del modelado de sistemas de tipo
péndulo invertido, se pueden ver también en campos como el aeroespacial, en el cual se requiere el
control activo de un cohete para mantenerlo en la posición vertical invertida durante su
despegue. En Biomecánica, el péndulo invertido es frecuentemente utilizado para modelar bípedos
caminantes, en los cuales la pierna de apoyo en contacto con el suelo a menudo se modela como un
péndulo invertido \citep{Cruz}.

Los robots de dos ruedas, tienen la ventaja de que son altamente maniobrables, al poder girar sobre
su propio eje. También, pueden construirse altos sin requerir de una base muy grande, lo que los
hace muy útiles en interiores, en donde pueden pasar por lugares estrechos y dar curvas muy cerradas
\citep{KarlStol}.  Algunas de sus aplicaciones, pueden ser como guías de excursiones dentro de
museos, bases de equipo médico dentro de hospitales, para vigilancia (segway) y de limpieza en el
hogar \citep{Coelho}.


\subsection{Descripción general de los robots de dos ruedas}

El sistema que se estudia son los robots de dos ruedas coaxiales, encontrándose normalmente una a
cada lado del cuerpo, con el centro de masa sobre el eje de las ruedas. Debido a que el centro de
masa se encuentra sobre el eje de las ruedas, estos robots también son conocidos como péndulos
invertidos móviles \citep{Yan-Hou}, ya que su base no está fija en el espacio, sino que puede
desplazarse sobre una superficie debido a la acción de las ruedas (ver figura
\ref{fig:segway_robot}).

Estos robots tienen 3 grados de libertad, los cuales son: traslación hacia adelante o atrás, giro
sobre su propio eje (yaw), y giro sobre el eje de las ruedas (pitch) (ver figura
\ref{fig:axis}). Sin embargo, el robot únicamente tiene dos actuadores (las dos ruedas). Por lo
tanto, se considera un sistema subactuado \citep{Xu}. De esta manera, no se puede lograr el control
del movimiento del robot en los tres grados de libertad de forma independiente, ya que si se
controla uno de ellos, los otros también se ven afectados. 

En el caso particular de este trabajo, el análisis se centrará en la descripción del péndulo
invertido, por lo que el ángulo de yaw no se tomará en cuenta dentro del modelo.

\begin{figure}
	\centering
	\includegraphics[width=0.6\textwidth]{../pictures/robot-segway.png}	
	\caption{Ejemplo de robot de dos ruedas}
	\label{fig:segway_robot}
\end{figure}

Se debe notar que para que el sistema sea estable, se necesitan al menos tres puntos de apoyo
\citep{KarlStol}. La mayor propiedad de este sistema, es que se considera dinámicamente estable
\citep{Yan-Hou} o estáticamente inestable \citep{KarlStol}, esto porque se debe tener un controlador
activo para mantener al sistema cerca de un punto de operación, y así evitar que se caiga.

%Figura 2 de modelling and control of two wheeled robots

\begin{figure}
	\centering
	\includegraphics[width=0.4\textwidth]{../pictures/Axis.pdf}	
	\caption{Grados de libertad de un robot de dos ruedas}
	\label{fig:axis}
\end{figure}

%\subsection{Consideraciones Iniciales}
%El objetivo de estos sistemas es evitar que se caigan, entonces es conveniente tomar la salida como
%el ángulo respecto a la normal con el suelo, es decir el ángulo pitch, denotado como $\phi$. Por
%otra parte, la entrada son los torques que actúan sobre el cuerpo. El torque que provoca la gravedad
%puede no ser considerado como una entrada, pero el torque de las ruedas y el torque de
%perturbaciones externas (como empujar al robot), sí corresponden a entradas.

\subsection{Método de linealización}
Los sistemas en estudio son intrínsicamente no lineales \citep{Sayidmarie}. De esta manera, para
facilitar el análisis se puede considerar el sistema alrededor de un punto de operación específico,
en donde el mismo puede considerarse como lineal. En el caso específico del sistema a analizar,
si se denomina $\phi$ cómo el ángulo de pitch, ya que el interés es mantener al robot en posición
vertical, se puede tomar como punto de operación la condición de $\phi=0$.

En general, se tiene que el modelo en variables de estado de un sistema no lineal viene dado por la
ecuación \ref{eq:estados_no_lineal}:

\begin{equation}
\frac{d\mathbf{x}(t)}{dt}=f(\mathbf{x}(t),\mathbf{u}(t))
\label{eq:estados_no_lineal}
\end{equation}

Ahora, por el teorema del valor medio, se sabe que existe $t_0<\delta<t$ tal que (ecuación
\ref{eq:mean_theorem}):

\begin{equation}
J_f(\mathbf{x},\mathbf{u})(\mathbf{x}(t_0+\delta)+\mathbf{u}(t_0+\delta))=\frac{f(\mathbf{x}(t),\mathbf{u}(t))-f(\mathbf{x}(t_0),\mathbf{u}(t_0))}{t-t_0}
\label{eq:mean_theorem}
\end{equation}
 
En donde $J_f$ es el jacobiano de $f$. Para el caso particular del punto de operación, se tiene que
$t_0=0$. Como se supone que $t$ es muy cercano a $0$, entonces se aproxima que $\delta=0$. Por otro
lado, $J_{f_x}$ y $J_{f_u}$ son las porciones del jacobiano de $f$ que dependen únicamente de
$\mathbf{x}$ y $\mathbf{u}$, respectivamente.

Se define $\mathbf{x'}(t)=\mathbf{x}(t)-\mathbf{x}(0)$ y
$\mathbf{u'}(t)=\mathbf{u}(t)-\mathbf{u}(0)$. Despejando $f$ de la ecuación \ref{eq:mean_theorem}, y
sustituyendo \ref{eq:estados_no_lineal}, se obtiene la ecuación \ref{eq:meantheo}:

\begin{equation}
\frac{dx'(t)}{dt}=J_{f_x}|_0\mathbf{x'}(t)+J_{f_u}|_0\mathbf{u'}(t)
\label{eq:meantheo}
\end{equation}

De esta manera, se obtiene un modelo en variables de estado lineal cuando el ángulo de pitch es
cercano a cero \citep{Buck}.

\subsection{Análisis de sistemas mecánicos: Enfoque de energías}
Para modelar sistemas mecánicos como el que se estudiará en el presente trabajo, resulta conveniente
utilizar el enfoque de energías, el cual facilita obtener las ecuaciones del movimiento de sistemas
mecánicos con múltiples grados de libertad y que utilicen coordenadas generalizadas (no restringidas
a ser cartesianas).

Las coordenadas generalizadas de un sistema mecánico, se definen como la mínima cantidad de
parámetros que pueden definir de manera completa la configuración del sistema, siendo variables
independientes entre sí \citep{fitzpatrick2011}. Por otro lado, los grados de libertad son la
cantidad de coordenadas que pueden ser modificadas de manera independiente para determinar la
configuración de los cuerpos en el sistema \citep{vandiver2011}.

El Lagrangiano, definido como $L=T-V$, es función de las coordenadas generalizadas y de sus
respectivas derivadas \citep{gavin2014}, tal como se muestra en la ecuación \ref{eq:lagrangian}, en
donde $n$ es la cantidad de grados de libertad del sistema.

\begin{equation}
  L=L(q_{1},...q_{j}...q_{n}, \dot{q_{1}},...\dot{q_{j}}...\dot{q_{n}})
  \label{eq:lagrangian}
\end{equation}

La ecuación \ref{eq:euler-lagrange} se conoce como la ecuación de Euler-Lagrange, y permite obtener
una ecuación de movimiento para cada coordenada generalizada ($q_j$) \citep{vandiver2011}, lo que
genera un sistema de $n$ ecuaciones diferenciales de las cuales se puede construir el modelo en
variables de estado.

\begin{equation}
  \frac{d}{dt}\left(\frac{\partial L}{\partial \dot{q_j}}\right)-\frac{\partial
    L}{\partial q_j} = Q_j
\label{eq:euler-lagrange}
\end{equation}

El término $Q_j$ de la ecuación \ref{eq:euler-lagrange}, denominado fuerza generalizada
\citep{gavin2014}, consiste en el componente de la fuerza neta no conservativa del sistema que
realiza trabajo en la dirección de $q_j$, lo cual involucra las fuerzas externas y las disipativas.

Para poder utilizar las ecuaciones de Euler-Lagrange, es necesario que el sistema sea holonómico
\citep{vandiver2011}, lo que significa que la cantidad de coordenadas generalizadas a utilizar es
igual a la cantidad de grados de libertad del sistema.

La energía potencial y cinética que componen el Lagrangiano del sistema, dependen de factores como
el tipo de movimiento, la posición de los cuerpos y la constitución física de los mismos
(elasticidad). En el cuadro \ref{tab:energias}, se muestran algunos de los principales tipos de
dichas energías para sistemas mecánicos.

\begin{table}[]
\centering
\caption{Principales tipos de energías cinéticas y potenciales para un sistema mecánico}
\label{tab:energias}
\begin{tabular}{@{}ll@{}}
\toprule
\multicolumn{2}{l}{\textbf{Energía cinética (T)}} \\ \midrule
Traslacional & $\frac{1}{2} m {\left\lVert \vec{v} \right\rVert}^2  $   \\ \midrule
Rotacional & $\frac{1}{2} J {\omega}^2$ \\ \midrule
\multicolumn{2}{l}{\textbf{Energía potencial (V)}} \\ \midrule
Gravitacional & $mgh$ \\ \midrule
Elástica (Resorte) & $\frac{1}{2}k{x}^2$ \\ \bottomrule
\end{tabular}
\end{table}

\subsection{Modelo cinemático directo}

%\input{modelo_cinematico.tex}

\section{Resultados}

pseudo inversa

\[
\left(
\begin{array}{ccc}
 \frac{\cos (a) \left(-b^2 \cos ^2(a)-b^2 \sin ^2(a)+4\right)}{8 \left(\cos ^2(a)+\sin ^2(a)\right)}+\frac{\cos (a) \left(b^2 \cos
   ^2(a)+b^2 \sin ^2(a)+4\right)}{8 \left(\cos ^2(a)+\sin ^2(a)\right)} & \frac{\sin (a) \left(-b^2 \cos ^2(a)-b^2 \sin
   ^2(a)+4\right)}{8 \left(\cos ^2(a)+\sin ^2(a)\right)}+\frac{\sin (a) \left(b^2 \cos ^2(a)+b^2 \sin ^2(a)+4\right)}{8 \left(\cos
   ^2(a)+\sin ^2(a)\right)} & \frac{b^2 \cos ^2(a)+b^2 \sin ^2(a)+4}{4 b \left(\cos ^2(a)+\sin ^2(a)\right)}-\frac{-b^2 \cos
   ^2(a)-b^2 \sin ^2(a)+4}{4 b \left(\cos ^2(a)+\sin ^2(a)\right)} \\
 \frac{\cos (a) \left(-b^2 \cos ^2(a)-b^2 \sin ^2(a)+4\right)}{8 \left(\cos ^2(a)+\sin ^2(a)\right)}+\frac{\cos (a) \left(b^2 \cos
   ^2(a)+b^2 \sin ^2(a)+4\right)}{8 \left(\cos ^2(a)+\sin ^2(a)\right)} & \frac{\sin (a) \left(-b^2 \cos ^2(a)-b^2 \sin
   ^2(a)+4\right)}{8 \left(\cos ^2(a)+\sin ^2(a)\right)}+\frac{\sin (a) \left(b^2 \cos ^2(a)+b^2 \sin ^2(a)+4\right)}{8 \left(\cos
   ^2(a)+\sin ^2(a)\right)} & \frac{-b^2 \cos ^2(a)-b^2 \sin ^2(a)+4}{4 b \left(\cos ^2(a)+\sin ^2(a)\right)}-\frac{b^2 \cos
   ^2(a)+b^2 \sin ^2(a)+4}{4 b \left(\cos ^2(a)+\sin ^2(a)\right)} \\
\end{array}
\right)
\]



\section{Conclusiones y Recomendaciones}

Se logró exitosamente simular el sistema descrito. En las simulaciones se obtienen los resultados observados en el sistema real.

\newpage
%-------------------
%bibliografía
\addcontentsline{toc}{section}{Bibliografía}
\bibliographystyle{EIEBib}
%nombre del archivo .bib que contiene la bibliografía
\bibliography{informe_ref}

% ------------------- archivo de apéndice si fuera necesario (* si no hay apéndice comentar las
% siguientes dos líneas *)

%\addcontentsline{toc}{section}{Apéndices}

%------------------
%final del documento
\end{document}
% Lo que se escriba a partir de aquí será ignorado por el compilador